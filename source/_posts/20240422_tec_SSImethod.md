---
title: NURBS 曲面求交思路
category: 技术博客
mathjax: true
password: 12317003
---

# 问题
相比之前的文章，本文将讨论带有精度控制的 NURBS 曲面求交问题。

# 步骤

Stage 1:

1. 输入两个曲面 $S_1, S_2$，以及精度 $tol$。

2. 计算 $S_1, S_2$ 的包围盒。

3. 判断两个包围盒是否相交，若不相交则结束。

4. 若相交，对 $S_1, S_2$ 四叉细分。

5. 对每个四叉树节点，计算每个节点包围盒。

循环 step3-5，直到相交的节点包围盒的对角线长度小于 $tol$。

*Stage1 得到可能相交的区域。这些区域的细分 level 不同。*

Stage 2:

6. 使用 C-S 方法计算边界交点。

7. 对于曲面法向近似同向，且没有边界交点的区域，使用 SIGGRAPH 的方法追踪交点。

8. 使用追踪法，或使用细分法的结果计算曲线拓扑结构。

# 技术点说明

## 精度控制

使用李亚普兹方法控制精度。

对于一个区域 $[s,t]\times[u,v]$，使用区间计算方法带入到函数 $R_x, R_y, R_z$ 中，得到区间 $[R_xmin, R_xmax]\times[R_ymin, R_ymax]\times[R_zmin, R_zmax]$。根据区间的对角线长度，可以得到一个从参数域到物理空间的映射程度数值。利用这个数值，可以知道要达到目标精度，需要设定多大的参数。如四叉树的深度，数值方法的精度等。

## C-S 方法加速

stage1 后得到的区域不是均匀统一的，对于相交的叶子节点，树的深度不同。如何加速 C-S 计算？
**TO BE CONTINUED...**

## 四叉树与交点数据结构

对于非均匀的四叉树细分与边缘交点，四叉树的节点数据结构如何设计？交点数据结构如何设计？
**TO BE CONTINUED...**